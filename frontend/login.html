<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Login - Postgres and Chill</title>
<link rel="icon" href="logo.png" />

<style>
:root{
  --bg:#0e0e0e;
  --panel:#141414;
  --card:#1a1a1a;
  --text:#f5f5f5;
  --muted:#bbb;
  --brand:#DFA601;
  --brand2:#f0c52b;
}

body{
  font-family:'Segoe UI',sans-serif;
  background:var(--bg);
  color:var(--text);
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
}

/* Card */
.login-container{
  background:var(--card);
  padding:40px 32px;
  border-radius:12px;
  width:340px;
  box-shadow:0 2px 10px rgba(0,0,0,.5);
  text-align:center;
}

img.logo{height:50px;margin-bottom:15px;}
h1{color:var(--brand);font-size:1.8rem;margin-bottom:20px;}

input, button, .nav-btn{
  width:100%;
  box-sizing:border-box;
}

/* Inputs */
input{
  padding:12px;
  margin:10px 0;
  background:#222;
  border:none;
  border-radius:6px;
  color:#fff;
  font-size:1rem;
}

/* Primary Button */
button{
  padding:12px;
  margin-top:14px;
  background:var(--brand);
  border:none;
  border-radius:6px;
  color:#141414;
  font-weight:bold;
  cursor:pointer;
  font-size:1rem;
  transition:background-color .2s;
}
button:hover{background:var(--brand2);}

/* Secondary Button */
.nav-btn{
  margin-top:14px;
  padding:12px;
  background:transparent;
  border:1px solid var(--brand);
  color:var(--brand);
  border-radius:6px;
  cursor:pointer;
}
.nav-btn:hover{
  background:var(--brand);
  color:#141414;
}

.error{
  color:#ff5555;
  margin-top:10px;
  font-size:.9rem;
}

a{color:var(--brand);text-decoration:none;}
a:hover{text-decoration:underline;}

footer{
  margin-top:18px;
  color:#888;
  font-size:.9rem;
  text-align:center;
}
footer img{height:35px;margin-left:8px;vertical-align:middle;}
</style>
</head>

<body>

<div class="login-container">
  <img src="logo.png" class="logo">
  <h1>Postgres and Chill</h1>

  <!-- ENTER key works because it's inside a form -->
  <form id="loginForm" onsubmit="login(); return false;">
    <input type="text" id="username" placeholder="Username" autocomplete="username" required>
    <input type="password" id="password" placeholder="Password" autocomplete="current-password" required>

    <button type="submit">Login</button>
  </form>

  <p id="error" class="error"></p>

  <p>Don’t have an account? <a href="register.html">Register</a></p>

  <button class="nav-btn" onclick="location.href='index.html'">Return to Home</button>
</div>

<footer>
  © 2025 Postgres and Chill
  <img src="pnw.png">
</footer>

<script>
const apiBase = "http://localhost:8080/api";

/* ===================================
      WORKING LOGIN (OLD LOGIC)
=================================== */
async function login() {
  const username = document.getElementById("username").value.trim();
  const password = document.getElementById("password").value.trim();
  const errorEl = document.getElementById("error");
  errorEl.textContent = "";

  if (!username || !password) {
    errorEl.textContent = "Please fill in both fields.";
    return;
  }

  try {
    const res = await fetch(`${apiBase}/users`);
    const users = await res.json();

    const user = users.find(u => 
      u.username === username && u.password === password
    );

    if (user) {
      localStorage.setItem("pc_userId", user.userId);
      localStorage.setItem("pc_userName", user.username);

      window.location.href = "dashboard.html";
    } else {
      errorEl.textContent = "Invalid username or password.";
    }

  } catch (e) {
    errorEl.textContent = "Server error. Try again later.";
  }
}
</script>



<script src="js/health-check.js"></script>


</body>
</html>
